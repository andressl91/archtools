

Keeping a list of explicitly installed packages can be useful to speed up installation on a new system:

$ pacman -Qqe > pkglist.txt

Note: If the option -t was used, when reinstalling the list all the non-top-level packages would be set as dependencies. With option -n, foreign packages (e.g. from AUR) would be omitted from the list.

To install packages from the list backup, run:

# pacman -S - < pkglist.txt

Tip:

    To skip already installed packages, use --needed.
    Use comm -13 <(pacman -Qqdt | sort) <(pacman -Qqdtt | sort) > optdeplist.txt to also create a list of the installed optional dependencies which can be reinstalled with --asdeps.

In case the list includes foreign packages, such as AUR packages, remove them first:

# pacman -S $(comm -12 <(pacman -Slq | sort) <(sort pkglist.txt))

To remove all the packages on your system that are not mentioned in the list:

# pacman -Rsu $(comm -23 <(pacman -Qq | sort) <(sort pkglist.txt))

